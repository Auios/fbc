#!/usr/bin/make -f
# @configure_input@

MKDIR_P:=@MKDIR_P@
EXEEXT:=@EXEEXT@
CFLAGS:=@CFLAGS@

build_noncanonical:=@build_noncanonical@
host_noncanonical:=@host_noncanonical@
target_noncanonical:=@target_noncanonical@

prefix:=@prefix@
srcdir:=@srcdir@
@SET_MAKE@

LIBFB_CONFARGS := --build=$(build_noncanonical) --host=$(target_noncanonical)
LIBFB_CONFARGS += --prefix=$(prefix)

.PHONY: all
all: SUBMAKE_TARGET = all
all: make-fbc make-libfb

.PHONY: make-fbc make-libfb
make-fbc: fbc/makefile
	cd fbc && $(MAKE) $(SUBMAKE_TARGET)
make-libfb: libfb/makefile
	cd libfb && $(MAKE) $(SUBMAKE_TARGET)

libfb/makefile:
	$(MKDIR_P) libfb && cd libfb && \
    ../$(srcdir)/libfb/configure $(LIBFB_CONFARGS)

.PHONY: install
install: SUBMAKE_TARGET = install
install: make-fbc make-libfb

.PHONY: clean
clean: SUBMAKE_TARGET = clean
clean: make-fbc make-libfb

.PHONY: distclean
distclean: SUBMAKE_TARGET = distclean
distclean: make-fbc make-libfb
	-rm -rf $(srcdir)/autom4te.cache config.log config.status \
    makefile fbc/makefile fbc/config.bi tests/makefile
